# 2.2.3: Pandas Operations, Sorting, and Data Cleaning - Exercises

This file contains exercises to practice the concepts from lesson 2.2.3. Try to solve them on your own before looking at the solutions. You will need to have `pandas` and `numpy` installed.

---

## Accessing and Indexing

### Exercise 1: Accessing Columns and Rows
1.  Import `pandas` and `numpy`.
2.  Create the following DataFrame:
    ```python
    data = {
        'Name': ['Alice', 'Bob', 'Charlie', 'David', 'Eva'],
        'Age': [25, 30, 35, 40, 22],
        'City': ['New York', 'Los Angeles', 'Chicago', 'Houston', 'Phoenix'],
        'Salary': [70000, 80000, 120000, 90000, 60000]
    }
    df = pd.DataFrame(data)
    df.set_index('Name', inplace=True)
    ```
3.  Access the 'Salary' column using both the `[]` operator and attribute-style access.
4.  Access the row for 'Charlie' using `.loc`.
5.  Access the row at integer position 2 using `.iloc`.

### Exercise 2: Slicing
1.  Using the DataFrame from Exercise 1, select rows from 'Bob' to 'David' (inclusive) using `.loc`.
2.  Select the first 3 rows and the first 2 columns using `.iloc`.
3.  Select the 'Age' and 'City' columns for 'Alice' and 'Eva'.

---

## Filtering and Modifying Data

### Exercise 3: Boolean Indexing
1.  Select all rows where 'Age' is greater than 30.
2.  Select all rows where 'City' is either 'New York' or 'Chicago'.
3.  Select the 'Name' and 'Salary' (Note: 'Name' is the index, so just 'Salary' and index) for people with a salary greater than 80000.

### Exercise 4: Adding and Removing Columns
1.  Add a new column 'Bonus' which is 10% of the 'Salary'.
2.  Add a boolean column 'Senior' which is True if 'Age' >= 35, else False.
3.  Remove the 'City' column using `del` or `.drop()`.
4.  Use `.pop()` to remove the 'Bonus' column and store it in a variable.

### Exercise 5: Using `assign`
1.  Reload the DataFrame from Exercise 1 (to get 'City' back or recreate it).
2.  Use the `assign()` method to create a new column 'Monthly_Salary' (Salary / 12) without modifying the original DataFrame.
3.  Print the new DataFrame returned by `assign()`.

---

## Sorting

### Exercise 6: Sorting by Index and Values
1.  Sort the DataFrame by its index (Name) in descending order.
2.  Sort the DataFrame by 'Age' in ascending order.
3.  Sort the DataFrame by 'Salary' in descending order.

---

## Operations and Aggregation

### Exercise 7: Arithmetic and Aggregation
1.  Create a DataFrame of grades:
    ```python
    grades = pd.DataFrame(
        np.random.randint(50, 100, size=(5, 3)),
        columns=['Math', 'Science', 'English'],
        index=['Alice', 'Bob', 'Charlie', 'David', 'Eva']
    )
    ```
2.  Add 5 bonus points to all grades.
3.  Calculate the average grade for each student (row-wise mean).
4.  Calculate the average score for each subject (column-wise mean).

---

## Data Cleaning

### Exercise 8: Handling Missing Data
1.  Create a DataFrame with missing values:
    ```python
    df_missing = pd.DataFrame({
        'A': [1, 2, np.nan, 4],
        'B': [5, np.nan, np.nan, 8],
        'C': [10, 11, 12, 13]
    })
    ```
2.  Check for missing values using `.isnull()`.
3.  Drop rows containing any missing values.
4.  Reset `df_missing` and fill missing values with 0.
5.  Reset `df_missing` and fill missing values with the mean of the respective column.

### Exercise 9: Handling Duplicates
1.  Create a DataFrame with duplicates:
    ```python
    df_dup = pd.DataFrame({
        'ID': [1, 2, 2, 3, 4, 4],
        'Value': ['A', 'B', 'B', 'C', 'D', 'D']
    })
    ```
2.  Identify duplicate rows using `.duplicated()`.
3.  Remove duplicate rows using `.drop_duplicates()`.

### Exercise 10: Data Type Conversion
1.  Create a DataFrame with string numbers:
    ```python
    df_str = pd.DataFrame({
        'Price': ['100', '200', '300', '400']
    })
    ```
2.  Check the data type of the 'Price' column.
3.  Convert the 'Price' column to integer type using `.astype(int)`.
4.  Verify the conversion by checking the dtypes again.

