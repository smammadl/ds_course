# 2.2.4: Pandas Data Transformation - Exercises

This file contains exercises to practice the concepts from lesson 2.2.4. Try to solve them on your own before looking at the solutions. You will need to have `pandas`, `numpy`, and `seaborn` installed.

---

## Merging, Joining, and Concatenating

### Exercise 1: Concatenating DataFrames
1.  Import `pandas` and `numpy`.
2.  Create two DataFrames:
    ```python
    df1 = pd.DataFrame({'A': ['A0', 'A1'], 'B': ['B0', 'B1']}, index=[0, 1])
    df2 = pd.DataFrame({'A': ['A2', 'A3'], 'B': ['B2', 'B3']}, index=[2, 3])
    ```
3.  Concatenate `df1` and `df2` vertically (stacking rows).
4.  Concatenate `df1` and `df2` horizontally (stacking columns).
5.  Create a third DataFrame:
    ```python
    df3 = pd.DataFrame({'A': ['A4', 'A5'], 'B': ['B4', 'B5']}, index=[0, 1])
    ```
6.  Concatenate `df1` and `df3` vertically. What happens to the indices? Use `ignore_index=True` to fix it.

### Exercise 2: Merging DataFrames (Inner, Outer, Left, Right)
1.  Create two DataFrames:
    ```python
    left = pd.DataFrame({'key': ['K0', 'K1', 'K2'], 'A': ['A0', 'A1', 'A2']})
    right = pd.DataFrame({'key': ['K0', 'K1', 'K3'], 'B': ['B0', 'B1', 'B3']})
    ```
2.  Perform an inner merge on the 'key' column.
3.  Perform an outer merge on the 'key' column.
4.  Perform a left merge on the 'key' column.
5.  Perform a right merge on the 'key' column.

### Exercise 3: Merging on Different Keys
1.  Create two DataFrames with different key column names:
    ```python
    df_employees = pd.DataFrame({'emp_id': [1, 2, 3, 4], 'name': ['Alice', 'Bob', 'Charlie', 'David']})
    df_salaries = pd.DataFrame({'id': [1, 2, 3, 5], 'salary': [50000, 60000, 70000, 80000]})
    ```
2.  Merge these DataFrames using `emp_id` from `df_employees` and `id` from `df_salaries`.
3.  Clean up the resulting DataFrame by dropping the redundant 'id' column.

---

## Aggregation and Grouping

### Exercise 4: GroupBy and Simple Aggregation
1.  Import `seaborn` and load the 'planets' dataset:
    ```python
    import seaborn as sns
    planets = sns.load_dataset('planets')
    ```
2.  Group the data by 'method' and count the number of planets discovered by each method.
    *Hint: Use the 'number' column for counting or just `.count()` on the groupby object.*
3.  Calculate the mean 'orbital_period' for each 'method'.

### Exercise 5: GroupBy with Multiple Aggregations
1.  Using the 'planets' dataset, group by 'method'.
2.  Calculate the `min`, `median`, and `max` of the 'mass' column for each method.
    *Hint: Use `.agg()` or `.aggregate()`.*

### Exercise 6: Aggregate, Filter, Transform, Apply
1.  Create a DataFrame:
    ```python
    df = pd.DataFrame({
        'Team': ['A', 'A', 'B', 'B', 'C', 'C'],
        'Points': [10, 15, 10, 20, 10, 5],
        'Assists': [5, 7, 5, 10, 5, 2]
    })
    ```
2.  **Aggregation**: Calculate the sum of 'Points' and 'Assists' for each 'Team'.
3.  **Filtering**: Filter out teams that have an average 'Points' score of less than 12.
4.  **Transformation**: Create a new column 'Points_Standardized' by subtracting the team's mean points from the 'Points' column (center the data within each group).
5.  **Apply**: Define a function that doubles the 'Points' if the sum of 'Assists' for the group is greater than 10. Apply this function to the groups.

---

## Pivot Tables

### Exercise 7: Creating Pivot Tables
1.  Load the 'titanic' dataset:
    ```python
    titanic = sns.load_dataset('titanic')
    ```
2.  Create a pivot table showing the mean 'survived' rate indexed by 'sex' and columns by 'class'.
3.  Add a 'margins' column to show the overall survival rate.

### Exercise 8: Advanced Pivot Tables
1.  Using the 'titanic' dataset, create a pivot table showing the `sum` of 'survived' (number of survivors) and the `mean` of 'fare'.
2.  Index the table by 'sex' and 'embarked', and use 'class' for the columns.
    *Hint: Pass a dictionary to `aggfunc`.*

